{% extends "index.html" %}
{% block title %}Dict{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block header %}
    {{ super() }}
{% endblock %}
{% block black %}
    {{ super() }}
{% endblock %}

{% block page %}
    <table class="layui-table" lay-data="{width: 1000, height:500, url:'/admin/dict/all', page:true, id:'idTest'}" lay-filter="demo">
  <thead>
    <tr>
      <th lay-data="{field:'id', width:100, sort: true}">ID</th>
      <th lay-data="{field:'name', width:500}">分类名称</th>
      <th lay-data="{ width:500, align:'center', toolbar: '#barDemo'}">操作</th>
    </tr>
  </thead>
</table>

<script type="text/html" id="barDemo">
  <a class="layui-btn layui-btn-xs" lay-event="add">add</a>
  <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
  <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>


<script src="../static/layui/layui.all.js" charset="utf-8"></script>
<script src="../static/layui/lay/modules/table.js" charset="utf-8"></script>
<script src="../static/layui/lay/modules/form.js" charset="utf-8"></script>
<script src="../static/jQuery.min.js" charset="utf-8"></script>

<script>


layui.use('table', function(){
  var table = layui.table;
  //监听工具条
  table.on('tool(demo)', function(obj){
    var data = obj.data;
    console.log(data)
    if(obj.event === 'edit'){
        $("#uid").val(data.id);
        $("#uname").val(data.name);
        $("#upassword").val(data.password);
        $("#uemail").val(data.email);
        if (data.role==1){
            $("#urole1").prop("checked",true);
        }else if (data.role==2) {
            $("#urole2").prop("checked",true);
        }
        layer.open({
              type: 1,
              area: ['600px', '360px'],
              shadeClose: true, //点击遮罩关闭
              content: $('#form')
            });

    } else if(obj.event === 'del'){
        $.get("/admin/user/del/"+data.id, function(data){
			if(data.code == 200){
			    table.reload('idTest', {
                    url: '/admin/user/list'
                });
			}
		});
    }else if (obj.event=='add'){
        layer.open({
              type: 1,
              area: ['600px', '360px'],
              shadeClose: true, //点击遮罩关闭
              content: $('#addform').html()
            });
    }
  });
});
</script>
    <script>
        layui.use('form', function(){
        var form = layui.form; //只有执行了这一步，部分表单元素才会自动修饰成功
        form.render();

        });
</script>

{% endblock %}

{% block body %}
    {{ super() }}
{% endblock %}
